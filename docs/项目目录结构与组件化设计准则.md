# 项目目录结构与组件化设计准则

**版本**: 1.0.1

## 1. 设计哲学
本项目放弃传统的扁平化结构，采用 **“组件化 (Component-Based)”** 架构。
* **物理隔离**: 每个功能模块都是一个独立的库（Library），强制解耦。
* **依赖倒置**: 业务模块（App）不依赖具体硬件（Driver），只依赖抽象接口（Core）。
* **平台无关**: 核心逻辑代码必须能在 PC (x86/M1) 上编译并运行单元测试。

## 2. 目录树详解
```text
Project_Root/
├── docs/                    # 文档中心 (本规范存放于此)
├── test/                    # 单元测试 (Native/Embedded)
├── platformio.ini           # 构建配置文件 (定义 C++17, 宏开关)
├── src/
│   └── main.cpp             # 【系统入口】仅负责组件组装与依赖注入，禁止写业务逻辑
│
└── lib/                     # 组件仓库 (一切皆组件)
    ├── Kit_Utils/           # 【基础设施】
    │   ├── include/Log.h    # 零成本日志宏
    │   └── src/
    │
    ├── Kit_Core/            # 【核心契约】(纯虚接口、协议定义)
    │   ├── include/
    │   │   ├── ITransport.h     # 传输层接口
    │   │   ├── IPacketHandler.h # 包处理接口
    │   │   └── ProtocolDef.h    # 二进制协议结构体 (双端共用)
    │   └── src/
    │
    ├── Driver_Hal/          # 【硬件适配层】(实现 Kit_Core 接口)
    │   ├── include/
    │   │   ├── UartTransport.h  # ESP32/STM32 串口实现
    │   │   ├── SDStorageDriver.h
    │   │   └── MuxDriver.h      # CD4052 驱动
    │   └── src/
    │
    ├── App_Glove/           # 【业务：手套控制】
    │   ├── include/GloveManager.h
    │   └── src/             # 依赖 Kit_Core，不依赖 Driver_Hal
    │
    ├── App_Storage/         # 【业务：数据存储】
    │   ├── include/StorageService.h
    │   └── src/
    │
    └── App_System/          # 【业务：系统调度】
        ├── include/PacketDispatcher.h
        └── src/
```

## 3. 依赖注入原则
禁止 App_Glove 直接 #include "UartTransport.h"。

必须 在 main.cpp 中实例化 UartTransport，并将其指针 (ITransport*) 传递给 App_Glove::init()。